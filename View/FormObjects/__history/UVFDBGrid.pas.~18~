unit UVFDBGrid;

interface

uses
  Vcl.DBGrids, Graphics, StdCtrls, Forms, Classes, Controls, Variants,
  UMCGetDataSource;

type
  IGridDB = interface
    function GetGridDB(Cleft, Ñtop, CWidth, CHeight, FontSize: integer; CurrentForm: TForm): TDBGrid;
    procedure OpenConnect(SQL: string);
    procedure CloseConnect;
    procedure TitleColumn(NumberColumn: integer; NameColumn: string);
    procedure WidthColumn(NumberColumn, WidthCol: integer);
    procedure Enable(i: Boolean);
  end;

  TGridDB = class(TInterfacedObject, IGridDB)
  private
    TempDBGrid: TDBGrid;
    TempDataSource: IGetDataSource;
    SQL: String;
  public
    function GetGridDB(Cleft, Ñtop, CWidth, CHeight, FontSize: integer; CurrentForm: TForm): TDBGrid;
    procedure OpenConnect(SQL: string);
    procedure CloseConnect;
    procedure TitleColumn(NumberColumn: integer; NameColumn: string);
    procedure WidthColumn(NumberColumn, WidthCol: integer);
    procedure Enable(i: Boolean);
  end;

implementation

{ TTempLabelTag5 }

procedure TGridDB.CloseConnect;
begin
  TempDataSource.CloseConnect;
end;

procedure TGridDB.OpenConnect(SQL: string);
begin
  if not Assigned(TempDataSource) then
    TempDataSource := TGetDataSource.create(SQL);
  TempDBGrid.DataSource:=TempDataSource.GetDataSource;
  TempDataSource.OpenConnect;
end;

procedure TGridDB.TitleColumn(NumberColumn: integer; NameColumn: string);
begin
  TempDBGrid.Columns[NumberColumn].Title.Caption:=NameColumn;
end;

procedure TGridDB.WidthColumn(NumberColumn, WidthCol: integer);
begin
  TempDBGrid.Columns[NumberColumn].Width:=WidthCol;
end;

procedure TGridDB.Enable(i: Boolean);
begin
  TempDBGrid.Enabled:=i;
end;

function TGridDB.GetGridDB(Cleft, Ñtop, CWidth, CHeight, FontSize: integer; CurrentForm: TForm): TDBGrid;
begin
  if not Assigned(TempDBGrid) then
    TempDBGrid := TDBGrid.create(CurrentForm);
  TempDBGrid.parent := CurrentForm;
  with TempDBGrid do
  begin
    left := Cleft;
    top := Ñtop;
    Width := CWidth;
    Height:= CHeight;
    Font.Size := FontSize;
    Font.name := 'Times New Roman';
    ReadOnly:=true;
    TitleFont.Size := FontSize;
    TitleFont.name := 'Times New Roman';
    TitleFont.Style:=[fsbold];
    Tag := 5;
  end;
  result := TempDBGrid;
end;


end.
