unit UMSBlockMainMenu;

interface

Uses
  Menus, Forms;

type
  TBlockMainMenu = class
  public
    Procedure BlockMainMenu(i: Boolean; Form: TForm);
  end;

implementation

{ TBlockMainMenu }

procedure TBlockMainMenu.BlockMainMenu(i: Boolean; Form: TForm);
var
  k, j: integer; // в цикле должна быть именно локальная переменная
begin
  For k := Form.ComponentCount - 1 downto 1 do
  begin
    if Form.components[k].Tag = 4 then
    begin
      for j:=0 to (Form.Components[k] as TMainMenu).Items.Count-1 do
        (Form.Components[j] as TMainMenu).Items.Enabled:=i;
      exit;
    end;
  end;
end;

{for i:=0 to MainMenu1.Items.Count-1 do
    MainMenu1.Items[i].Enabled := false;}

end.
